<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="limpca">
<title>Application of `limpca` on the UCH metabolomics dataset. • limpca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Application of `limpca` on the UCH metabolomics dataset.">
<meta property="og:description" content="limpca">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">limpca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.99.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/limpca.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-article">Article</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-article">
    <h6 class="dropdown-header" data-toc-skip>Vignettes</h6>
    <a class="dropdown-item" href="../articles/UCH.html">UCH</a>
    <a class="dropdown-item" href="../articles/Trout.html">Trout</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/suppl_files/suppl_files.html">Supplementary information</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ManonMartin/limpca/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Application of `limpca` on the UCH metabolomics dataset.</h1>
                        <h4 data-toc-skip class="author">Benaiche Nadia,
Sébastien Franceschini, Martin Manon, Thiel Michel, Govaerts
Bernadette</h4>
            
            <h4 data-toc-skip class="date">February 16, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ManonMartin/limpca/blob/HEAD/vignettes/UCH.Rmd" class="external-link"><code>vignettes/UCH.Rmd</code></a></small>
      <div class="d-none name"><code>UCH.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">'pander'</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Install 'pander' to knit this vignette"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">'gridExtra'</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Install 'pander' to knit this vignette"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of this vignette is to show the possibilities offered by
the <code>limpca</code> package.</p>
<p><code>limpca</code> stands for linear modeling of high-dimensional
designed data based on ASCA/APCA family of methods. This package was
created to analyse models with high-dimensional data and a multi-factor
design of experiment and provides an implementation of ASCA and APCA
derived methods.</p>
<p>The model used in this example is a three-way ANOVA with fixed
effects. This document presents all the usual steps of the analysis,
from importing the data to visualising the results. Details on the
methods used and the package implementation can be found in the articles
of <span class="citation">Thiel, Feraud, and Govaerts (2017)</span>,
<span class="citation">Guisset, Martin, and Govaerts (2019)</span> and
<span class="citation">Thiel et al. (2023)</span>.</p>
<p>The motivation of publishing <code>limpca</code> in
<code>bioconductor</code> is twofold. First, no
<code>bioconductor</code> package includes ASCA/APCA methods and other
<code>R</code> packages implementing them are very basic as explained in
the literature review of <span class="citation">Thiel et al.
(2023)</span>. Secondly, ASCA/APCA are highly informative methods to
analyse -omics data tables in a multivariate framework as a complement
to differential analyses packages like <code>limma</code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package is actually in its development stage and is available on
GitHub: <a href="https://github.com/ManonMartin/limpca" class="external-link uri">https://github.com/ManonMartin/limpca</a>. It can be
installed via the <code>remotes::install_github</code> function. The
package needs to be loaded afterwards.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span>pkgs<span class="op">=</span><span class="st">"remotes"</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ManonMartin/limpca"</span>, </span>
<span>                        dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ManonMartin/limpca" class="external-link">"limpca"</a></span><span class="op">)</span></span></code></pre></div>
<p>Note that if you would like to build the vignettes, you have to
install <code>BiocStyle</code> (from <a href="https://www.bioconductor.org/" class="external-link">Bioconductor</a>) and
<code>rmarkdown</code> packages before installing <code>limpca</code>
with the following command:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ManonMartin/limpca"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-importation">Data importation<a class="anchor" aria-label="anchor" href="#data-importation"></a>
</h2>
<p>Before any analysis, the <code>UCH</code> data set needs to be
loaded. The <code>limpca</code> package contains the data set and it can
be loaded with the <code>data</code> function. The <code>load</code>
function is also useful to import your own data in an R format.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"UCH"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-exploration">Data exploration<a class="anchor" aria-label="anchor" href="#data-exploration"></a>
</h2>
<p>The UCH (Urine-Citrate-Hippurate) data set is described in <span class="citation">Thiel, Feraud, and Govaerts (2017)</span> and <span class="citation">Guisset, Martin, and Govaerts (2019)</span> and is
issued form a metabolomics experiment. In this experiment, 36 samples of
a pool of rat urine samples were spiked with two molecules Citrate and
Hippurate according to a <span class="math inline">\(3^2\)</span> full
factorial design in the quantities of these two molecules. The spiked
samples were analyzed by <sup>1</sup>H NMR at two different time after
defrozing and over two different days. Two of the spectra where finally
missing at the end of the experiment.</p>
<p>The UCH data set is a list containing 2 elements:</p>
<ul>
<li>an <code>outcomes</code> matrix with 34 observations of 600 response
variables representing the spectra from the <sup>1</sup>H NMR
spectroscopy,</li>
<li>a <code>design</code> matrix with 34 observations and 4 explanatory
variables</li>
</ul>
<p>A <code>formula</code> with the general linear model to be estimated
will be added to this list below.</p>
<p>For the purpose of this example, only 3 factors of interest will be
studied : concentrations of Hippurate and Citrate and Time after
defrozing.</p>
<p>Here are the <code>limpca</code> functions that are available for
data exploration.</p>
<div class="figure">
<img src="figs/limpcaDEfunctions.png" title="limpca data exploration functions" alt=""><p class="caption">limpca data exploration functions</p>
</div>
<div class="section level3">
<h3 id="design">Design<a class="anchor" aria-label="anchor" href="#design"></a>
</h3>
<p>The design matrix contains the information about each observation for
the four variables: Hippurate, Citrate, Day and Time. Only 3 of these
variables are used in the model. The function <code>plotDesign</code> is
useful to visualise the design.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">UCH</span><span class="op">$</span><span class="va">design</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:86%;" class="table">
<colgroup>
<col width="22%">
<col width="16%">
<col width="13%">
<col width="15%">
<col width="8%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate</th>
<th align="center">Citrate</th>
<th align="center">Dilution</th>
<th align="center">Day</th>
<th align="center">Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">diluted</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">diluted</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">diluted</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">diluted</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">diluted</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">diluted</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDesign.html">plotDesign</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>, x <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>           y <span class="op">=</span> <span class="st">"Citrate"</span>, rows <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>           title <span class="op">=</span> <span class="st">"Design of the UCH dataset"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Design%20visualization-1.png" width="250"></p>
<p>This plot confirms that the design is a full 3x3x2 factorial design
replicated twice with 2 missing values. Hence, the design is not
balanced.</p>
</div>
<div class="section level3">
<h3 id="outcomes-visualization">Outcomes visualization<a class="anchor" aria-label="anchor" href="#outcomes-visualization"></a>
</h3>
<p>The 600 response (<code>outcomes</code>) variables represent, for
each observation, the intensities of the <sup>1</sup>H NMR spectra.
These spectra can be visualized by the <code>plotLine</code>
function.</p>
<div class="section level4">
<h4 id="plotline-function">
<code>plotLine</code> function<a class="anchor" aria-label="anchor" href="#plotline-function"></a>
</h4>
<p>Here, annotations (<code>cit_peaks</code> and <code>hip_peaks</code>)
are added to the <code>ggplot</code> objects in order to highlight the
Hippurate (green) and Citrate (red) peaks.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotLine.html">plotLine</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"H-NMR spectrum"</span>,</span>
<span>         rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"ppm"</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cit_peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.509</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.709</span><span class="op">)</span>, </span>
<span>              ymin<span class="op">=</span><span class="op">-</span><span class="cn">Inf</span>, ymax<span class="op">=</span><span class="cn">Inf</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>              fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">hip_peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.458</span>,<span class="fl">3.881</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.935</span>,<span class="fl">4.041</span><span class="op">)</span>, </span>
<span>              ymin<span class="op">=</span><span class="op">-</span><span class="cn">Inf</span>, ymax<span class="op">=</span><span class="cn">Inf</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>              fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yellowgreen"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotLine.html">plotLine</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"H-NMR spectrum"</span>,</span>
<span>         rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"ppm"</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">cit_peaks</span> <span class="op">+</span> <span class="va">hip_peaks</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Spectrum%20visualization-1.png" width="250"></p>
</div>
<div class="section level4">
<h4 id="plotscatter-function">
<code>plotScatter</code> function<a class="anchor" aria-label="anchor" href="#plotscatter-function"></a>
</h4>
<p>The <code>plotScatter</code> function enables to visualize the values
of two outcomes variables with different colors or markers for the
values of the design factors. Here, it is used to show that the <span class="math inline">\(3^2\)</span> factorial design can be recovered
from the intensities of the Hippurate and Citrate peaks in the
spectra.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># xy corresponds to citrate (453) and hippurate peaks (369)</span></span>
<span><span class="fu"><a href="../reference/plotScatter.html">plotScatter</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span>,</span>
<span>            xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">453</span>, <span class="fl">369</span><span class="op">)</span>,</span>
<span>            design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>            shape <span class="op">=</span> <span class="st">"Citrate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-2-1.png" width="250"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or refering to the variables names (ppm values here)</span></span>
<span><span class="fu"><a href="../reference/plotScatter.html">plotScatter</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span>,</span>
<span>            xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2.6092056"</span>,<span class="st">"3.9811536"</span><span class="op">)</span>,</span>
<span>            design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>            shape <span class="op">=</span> <span class="st">"Citrate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-2-2.png" width="250"></p>
</div>
<div class="section level4">
<h4 id="plotscatterm-function">
<code>plotScatterM</code> function<a class="anchor" aria-label="anchor" href="#plotscatterm-function"></a>
</h4>
<p>The <code>plotScatter</code> function allows to visualize the values
of a series of outcomes variables with different colors or markers for
the values of the design factors. Here, it is done for the 4 peaks of
Hippurate and single peak of Citrate.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotScatterM.html">plotScatterM</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">133</span>, <span class="fl">145</span>, <span class="fl">150</span>, <span class="fl">369</span>, <span class="fl">453</span><span class="op">)</span>, </span>
<span>             design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,varname.colorup <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>             varname.colordown <span class="op">=</span> <span class="st">"Citrate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-3-1.png" width="300"></p>
</div>
<div class="section level4">
<h4 id="plotmeans-function">
<code>plotMeans</code> function<a class="anchor" aria-label="anchor" href="#plotmeans-function"></a>
</h4>
<p>The <code>plotMeans</code> represents the mean values of a response
variable for different levels of the design factors. Here we show the
evolution of the Citrate peak height with respect to the three design
factors of interest. Note that the results of this function must be
interpreted with caution for unbalanced designs because simple means are
biased estimators of expected means.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotMeans.html">plotMeans</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span>,</span>
<span>          design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,</span>
<span>          cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">453</span><span class="op">)</span>,</span>
<span>           x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Citrate"</span><span class="op">)</span>,</span>
<span>          w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span><span class="op">)</span>,</span>
<span>          z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span>,</span>
<span>          ylab <span class="op">=</span> <span class="st">"Intensity"</span>,</span>
<span>          title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean reponse for main Citrate peak"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$`2.6092056`</code></pre>
<p><img src="UCH_files/figure-html/unnamed-chunk-4-1.png" width="250"></p>
</div>
</div>
<div class="section level3">
<h3 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h3>
<p>The function <code>pcaBySvd</code> is useful to compute a Principal
Component Analysis (PCA) decomposition of the <code>outcomes</code>
matrix. Several functions can be applied to the output value of
<code>pcaBySvd</code>:</p>
<ul>
<li>
<code>pcaScreePlot</code> to obtaine a scree plot</li>
<li>
<code>pcaLoading1dPlot</code> for the loading plots</li>
<li>
<code>pcaScorePlot</code> for the score plots</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ResPCA</span> <span class="op">=</span> <span class="fu"><a href="../reference/pcaBySvd.html">pcaBySvd</a></span><span class="op">(</span><span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcaScreePlot.html">pcaScreePlot</a></span><span class="op">(</span><span class="va">ResPCA</span>, nPC <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> </span></code></pre></div>
<p><img src="UCH_files/figure-html/PCA-1.png" width="250"></p>
<p>The score plots below indicate that all tree factors from the design
affect the spectral profiles, which will be more clearly highlighted by
ASCA and APCA.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span>resPcaBySvd <span class="op">=</span> <span class="va">ResPCA</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"PCA scores plot: PC1 and PC2"</span>, </span>
<span>             design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Citrate"</span>,</span>
<span>             points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Scores-1.png" width="250"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span>resPcaBySvd <span class="op">=</span> <span class="va">ResPCA</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"PCA scores plot: PC1 and PC2"</span>, </span>
<span>             design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"Time"</span>, shape <span class="op">=</span> <span class="st">"Hippurate"</span>,</span>
<span>             points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Scores-2.png" width="250"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span>resPcaBySvd <span class="op">=</span> <span class="va">ResPCA</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"PCA scores plot: PC3 and PC4"</span>, </span>
<span>             design <span class="op">=</span> <span class="va">UCH</span><span class="op">$</span><span class="va">design</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"Time"</span>, shape <span class="op">=</span> <span class="st">"Citrate"</span>,</span>
<span>             points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Scores-3.png" width="250"></p>
<p>In the first two loading plots, a mixture of Citrate and Hippurate
peaks already appears but they are not separated.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcaLoading1dPlot.html">pcaLoading1dPlot</a></span><span class="op">(</span>resPcaBySvd <span class="op">=</span> <span class="va">ResPCA</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"PCA loadings plot UCH"</span>, xlab <span class="op">=</span> <span class="st">"ppm"</span>, </span>
<span>               ylab <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">+</span>  <span class="va">hip_peaks</span> <span class="op">+</span> <span class="va">cit_peaks</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Loadings-1.png" width="250"></p>
</div>
</div>
<div class="section level2">
<h2 id="application-of-asca-and-apca">Application of ASCA+ and APCA+<a class="anchor" aria-label="anchor" href="#application-of-asca-and-apca"></a>
</h2>
<p>Here below, ASCA+ and APCA+ steps are illustrated on the
<code>UCH</code> data set. The following graph represents the steps of
the methodology.<br><img src="figs/ASCAMethodo.png" title="ASCA+/APCA+ methodology" alt="ASCA+/APCA+ methodology"> The next graph presents the functions
available in <code>limpca</code> for this purpose. They are all
illustrated in the next sections.</p>
<div class="figure">
<img src="figs/limpcaASCAfunctions.png" title="limpca ASCA/PCA functions" alt=""><p class="caption">limpca ASCA/APCA functions</p>
</div>
</div>
<div class="section level2">
<h2 id="model-estimation-and-effect-matrix-decomposition">Model estimation and effect matrix decomposition<a class="anchor" aria-label="anchor" href="#model-estimation-and-effect-matrix-decomposition"></a>
</h2>
<div class="section level3">
<h3 id="model-formula">Model formula<a class="anchor" aria-label="anchor" href="#model-formula"></a>
</h3>
<p>The formula of the ANOVA-GLM model used in this analysis is the 3
ways crossed ANOVA model:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UCH</span><span class="op">$</span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="st">"outcomes ~ Hippurate + Citrate + Time + Hippurate:Citrate + </span></span>
<span><span class="st">                  Time:Hippurate + Time:Citrate + Hippurate:Citrate:Time"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-matrix-generation">Model matrix generation<a class="anchor" aria-label="anchor" href="#model-matrix-generation"></a>
</h3>
<p>The first step of ASCA+ is to build the (GLM) model matrix from the
experimental design matrix and the model. Each factor is reencoded with
multiple binary variables using <code>contr.sum</code> coding. The size
of the model matrix is 34xp with p being the total number of parameters
in the ANOVA model for one response.</p>
<p>The function <code>lmpModelMatrix</code> encodes the design matrix as
a model matrix.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpModelMatrix</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmpModelMatrix.html">lmpModelMatrix</a></span><span class="op">(</span><span class="va">UCH</span><span class="op">)</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">resLmpModelMatrix</span><span class="op">$</span><span class="va">modelMatrix</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="20%">
<col width="17%">
<col width="16%">
<col width="16%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">(Intercept)</th>
<th align="center">Hippurate1</th>
<th align="center">Hippurate2</th>
<th align="center">Citrate1</th>
<th align="center">Citrate2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">-1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">-1</td>
</tr>
</tbody>
</table>
<table style="width:94%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="22%">
<col width="11%">
<col width="30%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Time1</th>
<th align="center">Hippurate1:Citrate1</th>
<th align="center">Hippurate2:Citrate1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">-1</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="20%">
<col width="27%">
<col width="27%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate1:Citrate2</th>
<th align="center">Hippurate2:Citrate2</th>
<th align="center">Hippurate1:Time1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">-1</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">-1</td>
</tr>
</tbody>
</table>
<table style="width:96%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="22%">
<col width="26%">
<col width="23%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate2:Time1</th>
<th align="center">Citrate1:Time1</th>
<th align="center">Citrate2:Time1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">-1</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="22%">
<col width="38%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate1:Citrate1:Time1</th>
<th align="center">Hippurate2:Citrate1:Time1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="22%">
<col width="38%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate1:Citrate2:Time1</th>
<th align="center">Hippurate2:Citrate2:Time1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>M2C00D2R1</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C00D2R2</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C02D2R1</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C02D2R2</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>M2C04D2R1</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>M2C04D2R2</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="model-estimation-and-effect-matrices-decomposition">Model estimation and effect matrices decomposition<a class="anchor" aria-label="anchor" href="#model-estimation-and-effect-matrices-decomposition"></a>
</h3>
<p><code>lmpEffectMatrices</code> is the used to estimate the linear
model and decomposes the multivariate outcomes into effect matrices for
every model term. This function calculates also type III effect
contributions (in %) and generates a <code>barpot</code> to visualise
these contributions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpEffectMatrices</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmpEffectMatrices.html">lmpEffectMatrices</a></span><span class="op">(</span><span class="va">resLmpModelMatrix</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="effects-importance">Effects importance<a class="anchor" aria-label="anchor" href="#effects-importance"></a>
</h3>
<p>The contributions from each effect is outputted from
<code>lmpEffectMatrices</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpEffectMatrices</span><span class="op">$</span><span class="va">variationPercentages</span><span class="op">)</span></span></code></pre></div>
<table style="width:93%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="16%">
<col width="13%">
<col width="11%">
<col width="27%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="center">Hippurate</th>
<th align="center">Citrate</th>
<th align="center">Time</th>
<th align="center">Hippurate:Citrate</th>
<th align="center">Hippurate:Time</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">39.31</td>
<td align="center">29.91</td>
<td align="center">16.24</td>
<td align="center">1.543</td>
<td align="center">6.229</td>
</tr></tbody>
</table>
<table style="width:72%;" class="table">
<colgroup>
<col width="20%">
<col width="34%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center">Citrate:Time</th>
<th align="center">Hippurate:Citrate:Time</th>
<th align="center">Residuals</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">0.5387</td>
<td align="center">1.684</td>
<td align="center">4.298</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpEffectMatrices</span><span class="op">$</span><span class="va">varPercentagesPlot</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-5-1.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="bootstrap-tests-and-quantification-of-effects-importance">Bootstrap tests and quantification of effects importance<a class="anchor" aria-label="anchor" href="#bootstrap-tests-and-quantification-of-effects-importance"></a>
</h3>
<p><code>lmpBootstrapTests</code> applies a parametric bootstrap test to
determine whether an effect is significant or not. We recommend the user
to choose first a small value of <code>nboot</code> (e.g. nboot=100) to
develop its code and increase it later on (e.g. nboot=1000) in order to
get an accurate value for the p-values.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpBootstrapTests</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="../reference/lmpBootstrapTests.html">lmpBootstrapTests</a></span><span class="op">(</span>resLmpEffectMatrices <span class="op">=</span> <span class="va">resLmpEffectMatrices</span>, </span>
<span>                                         nboot<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print P-values</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">resLmpBootstrapTests</span><span class="op">$</span><span class="va">resultsTable</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="35%">
<col width="15%">
<col width="12%">
<col width="11%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate</th>
<th align="center">Citrate</th>
<th align="center">Time</th>
<th align="center">Hippurate:Citrate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>% of variance (T III)</strong></td>
<td align="center">39.31</td>
<td align="center">29.91</td>
<td align="center">16.24</td>
<td align="center">1.54</td>
</tr>
<tr class="even">
<td align="center"><strong>Bootstrap p-values</strong></td>
<td align="center">&lt; 0.01</td>
<td align="center">&lt; 0.01</td>
<td align="center">&lt; 0.01</td>
<td align="center">0.15</td>
</tr>
</tbody>
</table>
<table style="width:86%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="38%">
<col width="23%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate:Time</th>
<th align="center">Citrate:Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>% of variance (T III)</strong></td>
<td align="center">6.23</td>
<td align="center">0.54</td>
</tr>
<tr class="even">
<td align="center"><strong>Bootstrap p-values</strong></td>
<td align="center">&lt; 0.01</td>
<td align="center">0.4</td>
</tr>
</tbody>
</table>
<table style="width:90%;" class="table">
<colgroup>
<col width="38%">
<col width="34%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Hippurate:Citrate:Time</th>
<th align="center">Residuals</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>% of variance (T III)</strong></td>
<td align="center">1.68</td>
<td align="center">4.30</td>
</tr>
<tr class="even">
<td align="center"><strong>Bootstrap p-values</strong></td>
<td align="center">0.09</td>
<td align="center">-</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="ascaapcaasca-e-decomposition">ASCA/APCA/ASCA-E decomposition<a class="anchor" aria-label="anchor" href="#ascaapcaasca-e-decomposition"></a>
</h2>
<p>The ASCA/APCA/ASCA-E decomposition enables to represent the
information from the effect matrices in a space of reduced dimension
through PCA. The function <code>lmpPcaEffects</code> has a method
argument to define which method to use, namely <code>ASCA</code>,
<code>APCA</code> or <code>ASCA-E</code>. Combined effects matrices can
also be built and visualized by PCA.</p>
<div class="section level3">
<h3 id="asca">ASCA<a class="anchor" aria-label="anchor" href="#asca"></a>
</h3>
<p>The ASCA method performs PCA on the pure effect matrices. Here a
combined effect matrix <code>Hippurate+Time+Hippurate:Time</code> is
also built.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resASCA</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmpPcaEffects.html">lmpPcaEffects</a></span><span class="op">(</span>resLmpEffectMatrices <span class="op">=</span> <span class="va">resLmpEffectMatrices</span>, </span>
<span>                        method<span class="op">=</span><span class="st">"ASCA"</span>, </span>
<span>                        combineEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span>, <span class="st">"Time"</span>, </span>
<span>                                                <span class="st">"Hippurate:Time"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h4>
<p>The contribution of each principal component of the effects is
calculated and reported in different tables and plots with the function
<code>lmpContributions</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpContributions</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmpContributions.html">lmpContributions</a></span><span class="op">(</span><span class="va">resASCA</span><span class="op">)</span></span></code></pre></div>
<p>The tables are:</p>
<ul>
<li>
<code>totalContribTable</code>: Table of the <strong>contribution of
each effect to the total variance in percentage</strong> as outputted
from <code>lmpEffectMatrices</code>.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">totalContribTable</span><span class="op">)</span></span></code></pre></div>
<table style="width:75%;" class="table">
<colgroup>
<col width="40%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Percentage of Variance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Hippurate</strong></td>
<td align="center">39.31</td>
</tr>
<tr class="even">
<td align="center"><strong>Citrate</strong></td>
<td align="center">29.91</td>
</tr>
<tr class="odd">
<td align="center"><strong>Time</strong></td>
<td align="center">16.24</td>
</tr>
<tr class="even">
<td align="center"><strong>Hippurate:Citrate</strong></td>
<td align="center">1.54</td>
</tr>
<tr class="odd">
<td align="center"><strong>Hippurate:Time</strong></td>
<td align="center">6.23</td>
</tr>
<tr class="even">
<td align="center"><strong>Citrate:Time</strong></td>
<td align="center">0.54</td>
</tr>
<tr class="odd">
<td align="center"><strong>Hippurate:Citrate:Time</strong></td>
<td align="center">1.68</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">4.3</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>effectTable</code>: Table of the <strong>percentage of
variance explained by each Principal Component in each model effect
decomposition</strong>.</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">effectTable</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="38%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="9%">
<col width="9%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Hippurate</strong></td>
<td align="center">97.71</td>
<td align="center">2.29</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Citrate</strong></td>
<td align="center">98.22</td>
<td align="center">1.78</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="center"><strong>Time</strong></td>
<td align="center">100</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Hippurate:Citrate</strong></td>
<td align="center">44.01</td>
<td align="center">38.51</td>
<td align="center">15.13</td>
<td align="center">2.34</td>
<td align="center">0</td>
<td align="center">99.99</td>
</tr>
<tr class="odd">
<td align="center"><strong>Hippurate:Time</strong></td>
<td align="center">93.92</td>
<td align="center">6.08</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Citrate:Time</strong></td>
<td align="center">90.76</td>
<td align="center">9.24</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="center"><strong>Hippurate:Citrate:Time</strong></td>
<td align="center">47.23</td>
<td align="center">27.49</td>
<td align="center">22.6</td>
<td align="center">2.68</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">48.54</td>
<td align="center">16.9</td>
<td align="center">10.28</td>
<td align="center">5.93</td>
<td align="center">4.32</td>
<td align="center">85.97</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>combinedEffectTable</code>: Equivalent of the previous
<code>effectTable</code> but for the <em>combination of effects</em>
mentioned in <code>lmpPcaEffects</code>, here for
<code>Hippurate+Time+Hippurate:Time</code>.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">combinedEffectTable</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="43%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="8%">
<col width="8%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Hippurate+Time+Hippurate:Time</strong></td>
<td align="center">62.95</td>
<td align="center">26.32</td>
<td align="center">10.09</td>
<td align="center">0.48</td>
<td align="center">0.17</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">48.54</td>
<td align="center">16.9</td>
<td align="center">10.28</td>
<td align="center">5.93</td>
<td align="center">4.32</td>
<td align="center">85.97</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>contribTable</code>: Table of the <strong>percentage of
variance explained by each Principal Component of each effect reported
to the percentage contribution of the given effect to the total
variance</strong>. This table gives an overview of the importance of
each PC regardless of the effects.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">contribTable</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="38%">
<col width="10%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">Contrib</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Hippurate</strong></td>
<td align="center">38.41</td>
<td align="center">0.9</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">39.31</td>
</tr>
<tr class="even">
<td align="center"><strong>Citrate</strong></td>
<td align="center">29.37</td>
<td align="center">0.53</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">29.91</td>
</tr>
<tr class="odd">
<td align="center"><strong>Time</strong></td>
<td align="center">16.24</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">16.24</td>
</tr>
<tr class="even">
<td align="center"><strong>Hippurate:Citrate</strong></td>
<td align="center">0.68</td>
<td align="center">0.59</td>
<td align="center">0.23</td>
<td align="center">0.04</td>
<td align="center">0</td>
<td align="center">1.54</td>
</tr>
<tr class="odd">
<td align="center"><strong>Hippurate:Time</strong></td>
<td align="center">5.85</td>
<td align="center">0.38</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">6.23</td>
</tr>
<tr class="even">
<td align="center"><strong>Citrate:Time</strong></td>
<td align="center">0.49</td>
<td align="center">0.05</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0.54</td>
</tr>
<tr class="odd">
<td align="center"><strong>Hippurate:Citrate:Time</strong></td>
<td align="center">0.8</td>
<td align="center">0.46</td>
<td align="center">0.38</td>
<td align="center">0.05</td>
<td align="center">0</td>
<td align="center">1.68</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">2.09</td>
<td align="center">0.73</td>
<td align="center">0.44</td>
<td align="center">0.25</td>
<td align="center">0.19</td>
<td align="center">4.3</td>
</tr>
</tbody>
</table>
<ul>
<li>Moreover <code>lmpContributions</code> also produces a barplot
either with the ordered contributions per effect
(<code>plotTotal</code>) or across all the PCs of the different effects
(<code>plotContrib</code>).</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="st">"Ordered contributions per effect:"</span><span class="op">)</span></span></code></pre></div>
<p>Ordered contributions per effect:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">plotTotal</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-10-1.png" width="250"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="st">"For each PC of the different effects:"</span><span class="op">)</span></span></code></pre></div>
<p>For each PC of the different effects:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">plotContrib</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-10-2.png" width="250"></p>
<p>In the following analysis, we will focus only on the first PC of the
three main effects, the interaction <code>Hippurate:Time</code> and the
residuals since the other PCs and effects account for less than 1% of
the total variance.</p>
</div>
<div class="section level4">
<h4 id="scores-and-loadings-plots">Scores and loadings Plots<a class="anchor" aria-label="anchor" href="#scores-and-loadings-plots"></a>
</h4>
<p>The loadings can be represented either on a line plot with the
function <code>lmpLoading1dPlot</code> to conveniently compare them with
the original spectral profiles or on a scatterplot with the function
<code>lmpLoading2dPlot</code>.</p>
<p>Here we create an object including the loading plots (as line plots)
for all the effects included in the model as well as the combined effect
and the residuals.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_loadings_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpLoading1dPlot.html">lmpLoading1dPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>                              effectNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span>, <span class="st">"Citrate"</span>,<span class="st">"Time"</span>,</span>
<span>                                              <span class="st">"Hippurate:Time"</span>,</span>
<span>                                              <span class="st">"Hippurate+Time+Hippurate:Time"</span>,</span>
<span>                                              <span class="st">"Residuals"</span><span class="op">)</span>,</span>
<span>                              axes <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"ppm"</span><span class="op">)</span></span></code></pre></div>
<p>The score matrices are represented two components at a time on a
scatterplot with the function <code>lmpScorePlot</code>.</p>
<div class="section level5">
<h5 id="main-effects">Main effects<a class="anchor" aria-label="anchor" href="#main-effects"></a>
</h5>
<p>The scores and loadings of the main effects included in the model are
represented below.</p>
<p>They show that, thank to the ASCA analysis, Hippurate and Citrate
peaks are clearly and separately retrieved in the respective loading
plots compared to the classical PCA (see Section @ref(pca)) where peaks
of these two chemicals are both present in the two first PCs. The
loading profile of the <code>Time</code> effect shows a high peak on the
left side of the removed water area.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hippurate</span></span>
<span><span class="va">hip_scores_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Hippurate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hip_loadings_pl</span> <span class="op">&lt;-</span> <span class="va">all_loadings_pl</span><span class="op">$</span><span class="va">Hippurate</span> <span class="op">+</span>  <span class="va">hip_peaks</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">hip_scores_pl</span>,<span class="va">hip_loadings_pl</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCA%20ScoresXY-1.png" width="250"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Citrate</span></span>
<span><span class="va">cit_scores_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectNames <span class="op">=</span> <span class="st">"Citrate"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Citrate"</span>, shape <span class="op">=</span> <span class="st">"Citrate"</span><span class="op">)</span></span>
<span><span class="va">cit_loadings_pl</span> <span class="op">&lt;-</span> <span class="va">all_loadings_pl</span><span class="op">$</span><span class="va">Citrate</span> <span class="op">+</span>  <span class="va">cit_peaks</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">cit_scores_pl</span>,<span class="va">cit_loadings_pl</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCA%20ScoresXY-2.png" width="250"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time</span></span>
<span><span class="va">tim_scores_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectNames <span class="op">=</span> <span class="st">"Time"</span>, color <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>                              shape <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in FUN(X[[i]], ...): The variance of PC2 is inferior to 1%. Graph
scaled</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.955364</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.155364</span><span class="op">)</span>, </span>
<span>              ymin<span class="op">=</span><span class="op">-</span><span class="cn">Inf</span>, ymax<span class="op">=</span><span class="cn">Inf</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>              fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"royalblue"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">tim_loadings_pl</span> <span class="op">&lt;-</span> <span class="va">all_loadings_pl</span><span class="op">$</span><span class="va">Time</span> <span class="op">+</span>  <span class="va">time_peaks</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">tim_scores_pl</span>,<span class="va">tim_loadings_pl</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCA%20ScoresXY-3.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="interaction-hippuratetime">Interaction <code>Hippurate:Time</code><a class="anchor" aria-label="anchor" href="#interaction-hippuratetime"></a>
</h5>
<p>The scores and loadings fot the interaction term is represented here.
It is not straighforward to interpret the scores plot of such an
interaction term but the loadings of PC1 indicate a shift in the
spectrum, along the whole spectral profile (but mostly around 3
ppm).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hippurate:Time</span></span>
<span><span class="va">hiptim_scores_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate:Time"</span>, </span>
<span>                                 color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span>
<span><span class="va">hiptim_loadings_pl</span> <span class="op">&lt;-</span> <span class="va">all_loadings_pl</span><span class="op">$</span><span class="va">`Hippurate:Time`</span> <span class="op">+</span> </span>
<span>  <span class="va">time_peaks</span> <span class="op">+</span> </span>
<span>  <span class="va">hip_peaks</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">hiptim_scores_pl</span>,<span class="va">hiptim_loadings_pl</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-12-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="combination-of-effects-hippuratetimehippuratetime">Combination of effects
<code>Hippurate+Time+Hippurate:Time</code><a class="anchor" aria-label="anchor" href="#combination-of-effects-hippuratetimehippuratetime"></a>
</h5>
<p>The scores and the loadings of a combination of effects, in this case
<code>"Hippurate+Time+Hippurate:Time"</code> can also be visualised.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hippurate+Time+Hippurate:Time</span></span>
<span><span class="va">hiptimInter_scores_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>, </span>
<span>                            effectNames <span class="op">=</span> <span class="st">"Hippurate+Time+Hippurate:Time"</span>, </span>
<span>                            color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hiptimInter_loadings_pl</span> <span class="op">&lt;-</span> <span class="va">all_loadings_pl</span><span class="op">$</span><span class="va">`Hippurate:Time`</span> <span class="op">+</span> </span>
<span>                            <span class="va">time_peaks</span> <span class="op">+</span> <span class="va">hip_peaks</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">hiptimInter_scores_pl</span>,<span class="va">hiptimInter_loadings_pl</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-13-1.png" width="250"></p>
<p>However, note that a better graphical representation is possible with
the function <code>lmpEffectPlot</code> (see Section @ref(effects-plot))
to depict interaction terms or combinations of effects.</p>
</div>
<div class="section level5">
<h5 id="model-residuals">Model residuals<a class="anchor" aria-label="anchor" href="#model-residuals"></a>
</h5>
<p>PCA on the model residuals can also be applied to spot outliers or an
unexpected underlying structure of the data. The scores plot shows that
the effect of <code>Day</code>, which was excluded in our modeling step,
could have been included as well as it spans the two first PCs of the
residuals.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid_scores_pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectNames <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>                                color <span class="op">=</span> <span class="st">"Day"</span>, shape <span class="op">=</span> <span class="st">"Day"</span>, </span>
<span>                                drawShapes <span class="op">=</span> <span class="st">"segment"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">resid_loadings_pl</span> <span class="op">&lt;-</span> <span class="va">all_loadings_pl</span><span class="op">$</span><span class="va">Residuals</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">resid_scores_pl</span>,<span class="va">resid_loadings_pl</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/Plot%20Residuals-1.png" width="250"></p>
</div>
</div>
<div class="section level4">
<h4 id="other-graphs">Other graphs<a class="anchor" aria-label="anchor" href="#other-graphs"></a>
</h4>
<div class="section level5">
<h5 id="scores-scatter-plot">Scores scatter plot<a class="anchor" aria-label="anchor" href="#scores-scatter-plot"></a>
</h5>
<p>We can also represent the scores as a matrix of plots with
<code>lmpScoreScatterPlotM</code>. This graph has the advantage to
compare more than 2 variables simultaneously. For example, the PC1
scores of <code>Hippurate</code> and <code>Citrate</code> clearly
represent the orthogonal design of this experiment. The interaction
<code>Hippurate:Time</code> can also be clearly represented when
comparing les PC1s of <code>Hippurate</code> and the interaction
term.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScoreScatterPlotM.html">lmpScoreScatterPlotM</a></span><span class="op">(</span><span class="va">resASCA</span>,PCdim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                     modelAbbrev <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     varname.colorup <span class="op">=</span> <span class="st">"Citrate"</span>,</span>
<span>                     varname.colordown  <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>                     varname.pchup<span class="op">=</span><span class="st">"Hippurate"</span>,</span>
<span>                     varname.pchdown<span class="op">=</span><span class="st">"Time"</span>,</span>
<span>                     title <span class="op">=</span> <span class="st">"ASCA scores scatterplot matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCA%20ScoresMatrix-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="d-loadings">2D Loadings<a class="anchor" aria-label="anchor" href="#d-loadings"></a>
</h5>
<p>Finally the loadings can also be represented 2-by-2 as a scatterplot
with <code>lmpLoading2dPlot</code>. Such graphic is of course of limited
interest for spectral data.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span>resLmpPcaEffects<span class="op">=</span><span class="va">resASCA</span>, </span>
<span>                 effectNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span><span class="op">)</span>, </span>
<span>                 axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>                 addRownames <span class="op">=</span> <span class="cn">TRUE</span>,pl_n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
<p><img src="UCH_files/figure-html/ASCA%20loadings-1.png" width="250"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adding manually labels to points for the Hippurate peaks</span></span>
<span><span class="va">labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UCH</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">labels</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">369</span>, <span class="fl">132</span>, <span class="fl">150</span>, <span class="fl">133</span>, <span class="fl">149</span>, <span class="fl">144</span>, <span class="fl">145</span>, <span class="fl">368</span>, <span class="fl">151</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span>resLmpPcaEffects<span class="op">=</span><span class="va">resASCA</span>, </span>
<span>                 effectNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span><span class="op">)</span>, </span>
<span>                 axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, points_labs <span class="op">=</span> <span class="va">labels</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
<p><img src="UCH_files/figure-html/ASCA%20loadings-2.png" width="250"></p>
</div>
</div>
<div class="section level4">
<h4 id="effects-plot">Effects plot<a class="anchor" aria-label="anchor" href="#effects-plot"></a>
</h4>
<p>The <code>lmpEffectPlot</code> function is particularly interesting
to visualise an interaction term or a combination of effects. Note that
this function can only be applied with the <code>ASCA</code> method.</p>
<div class="section level5">
<h5 id="main-effects-for-hippurate">Main effects for <code>Hippurate</code><a class="anchor" aria-label="anchor" href="#main-effects-for-hippurate"></a>
</h5>
<p>Here the first PC of the <code>Hippurate</code> is represented along
the levels of this effect showing an expected linear effect of Hippurate
dose on the PC value.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectName <span class="op">=</span> <span class="st">"Hippurate"</span>, x <span class="op">=</span> <span class="st">"Hippurate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-14-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="interaction-hippuratetime-1">Interaction <code>Hippurate:Time</code><a class="anchor" aria-label="anchor" href="#interaction-hippuratetime-1"></a>
</h5>
<p>A more interesting application is the visualization of interaction
terms as line plots, here <code>Hippurate:Time</code> along the
<code>Hippurate</code> or the <code>Time</code> effect. This
representation gives the impression of a quite important interaction
effect.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectName <span class="op">=</span> <span class="st">"Hippurate:Time"</span>, </span>
<span>              x <span class="op">=</span> <span class="st">"Hippurate"</span>, z <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-15-1.png" width="250"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectName <span class="op">=</span> <span class="st">"Hippurate:Time"</span>, </span>
<span>              x <span class="op">=</span> <span class="st">"Time"</span>, z <span class="op">=</span> <span class="st">"Hippurate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/unnamed-chunk-15-2.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="combination-of-effects-hippuratetimehippuratetime-1">Combination of effects
<code>Hippurate+Time+Hippurate:Time</code><a class="anchor" aria-label="anchor" href="#combination-of-effects-hippuratetimehippuratetime-1"></a>
</h5>
<p>An alternative visualisation of this interaction combines the main
effects of <code>Hippurate</code>, <code>Time</code> and the interaction
<code>Hippurate:Time</code>. Even if significant, the interaction effect
is actually quite small compared to the main effects
(<code>Hippurate</code> for PC1 and <code>Time</code> for PC2).</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectName <span class="op">=</span> <span class="st">"Hippurate+Time+Hippurate:Time"</span>, </span>
<span>              x <span class="op">=</span> <span class="st">"Hippurate"</span>, z <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCA%20effects-1.png" width="250"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>, effectName <span class="op">=</span> <span class="st">"Hippurate+Time+Hippurate:Time"</span>, </span>
<span>              axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, x <span class="op">=</span> <span class="st">"Time"</span>, z <span class="op">=</span> <span class="st">"Hippurate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCA%20effects-2.png" width="250"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="apca">APCA<a class="anchor" aria-label="anchor" href="#apca"></a>
</h3>
<p>The APCA method performs PCA on the effect matrices augmented by the
residuals. The same functions already used for ASCA can be applied.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resAPCA</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmpPcaEffects.html">lmpPcaEffects</a></span><span class="op">(</span>resLmpEffectMatrices <span class="op">=</span> <span class="va">resLmpEffectMatrices</span>, </span>
<span>                        method<span class="op">=</span><span class="st">"APCA"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="scores-plot">Scores Plot<a class="anchor" aria-label="anchor" href="#scores-plot"></a>
</h4>
<p>Different shapes with the <code>drawShapes</code> argument highlight
the data structure recovery.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hippurate main effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Hippurate"</span>, drawShapes <span class="op">=</span> <span class="st">"ellipse"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-1.png" width="250"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Citrate main effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Citrate"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Citrate"</span>, shape <span class="op">=</span> <span class="st">"Citrate"</span>, drawShapes <span class="op">=</span> <span class="st">"ellipse"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-2.png" width="250"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time main effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Time"</span>, shape <span class="op">=</span> <span class="st">"Time"</span>, drawShapes <span class="op">=</span> <span class="st">"ellipse"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-3.png" width="250"></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Time"</span>, shape <span class="op">=</span> <span class="st">"Time"</span>, drawShapes <span class="op">=</span> <span class="st">"polygon"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-4.png" width="250"></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Time"</span>, shape <span class="op">=</span> <span class="st">"Time"</span>, drawShapes <span class="op">=</span> <span class="st">"segment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-5.png" width="250"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interaction term</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate:Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Time"</span>, drawShapes <span class="op">=</span> <span class="st">"segment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-6.png" width="250"></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate:Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Time"</span>, drawShapes <span class="op">=</span> <span class="st">"polygon"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresXY-7.png" width="250"></p>
<p>A scatterplot matrix can also be applied to visualise the
relationship between the scores profiles of interest.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScoreScatterPlotM.html">lmpScoreScatterPlotM</a></span><span class="op">(</span><span class="va">resAPCA</span>,</span>
<span>                     effectNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span>, <span class="st">"Citrate"</span>, <span class="st">"Time"</span>,</span>
<span>                                     <span class="st">"Hippurate:Time"</span><span class="op">)</span>,</span>
<span>                     modelAbbrev <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     varname.colorup <span class="op">=</span> <span class="st">"Citrate"</span>,</span>
<span>                     varname.colordown  <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>                     varname.pchup<span class="op">=</span><span class="st">"Hippurate"</span>,</span>
<span>                     varname.pchdown<span class="op">=</span><span class="st">"Time"</span>,</span>
<span>                     title <span class="op">=</span> <span class="st">"APCA scores scatterplot matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/APCA%20ScoresMatrix-1.png" width="250"></p>
</div>
<div class="section level4">
<h4 id="loadings-plot">Loadings plot<a class="anchor" aria-label="anchor" href="#loadings-plot"></a>
</h4>
<p>Note that the APCA loadings contain the residuals of the model and
differ from the ASCA loadings in that respect.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpLoading1dPlot.html">lmpLoading1dPlot</a></span><span class="op">(</span><span class="va">resAPCA</span>, effectNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span>, <span class="st">"Citrate"</span>, </span>
<span>                                        <span class="st">"Time"</span>, <span class="st">"Hippurate:Time"</span><span class="op">)</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>$Hippurate</code></pre>
<p><img src="UCH_files/figure-html/APCA%20loadings-1.png" width="250"></p>
<pre><code>
$Citrate</code></pre>
<p><img src="UCH_files/figure-html/APCA%20loadings-2.png" width="250"></p>
<pre><code>
$Time</code></pre>
<p><img src="UCH_files/figure-html/APCA%20loadings-3.png" width="250"></p>
<pre><code>
$`Hippurate:Time`</code></pre>
<p><img src="UCH_files/figure-html/APCA%20loadings-4.png" width="250"></p>
</div>
</div>
<div class="section level3">
<h3 id="asca-e">ASCA-E<a class="anchor" aria-label="anchor" href="#asca-e"></a>
</h3>
<p>The ASCA-E method performs PCA on the pure effect matrices then
projects the effect matrices augmented with residuals on the PC
obtained.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resASCAE</span> <span class="op">=</span> <span class="fu"><a href="../reference/lmpPcaEffects.html">lmpPcaEffects</a></span><span class="op">(</span>resLmpEffectMatrices <span class="op">=</span> <span class="va">resLmpEffectMatrices</span>, </span>
<span>                         method<span class="op">=</span><span class="st">"ASCA-E"</span><span class="op">)</span></span></code></pre></div>
<p>The contributions and loadings are identical to the ASCA results.</p>
<div class="section level4">
<h4 id="scores-plot-1">Scores Plot<a class="anchor" aria-label="anchor" href="#scores-plot-1"></a>
</h4>
<p>For the main effects, all score plots show a clear separation between
the different levels of the considered effects on the first PC. This
separation of the groups suggests a strong effect of those factors,
confirmed by their significance.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCAE</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Hippurate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCAE%20ScoresXY-1.png" width="250"></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCAE</span>, effectNames <span class="op">=</span> <span class="st">"Citrate"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Citrate"</span>, shape <span class="op">=</span> <span class="st">"Citrate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCAE%20ScoresXY-2.png" width="250"></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCAE</span>, effectNames <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Time"</span>, shape <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in FUN(X[[i]], ...): The variance of PC2 is inferior to 1%. Graph
scaled</code></pre>
<p><img src="UCH_files/figure-html/ASCAE%20ScoresXY-3.png" width="250"></p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCAE</span>, effectNames <span class="op">=</span> <span class="st">"Hippurate:Time"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"Hippurate"</span>, shape <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCAE%20ScoresXY-4.png" width="250"></p>
<p>Again, the scores profiles can be compared 2 by 2 with ASCA-E.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lmpScoreScatterPlotM.html">lmpScoreScatterPlotM</a></span><span class="op">(</span><span class="va">resASCAE</span>,</span>
<span>                     effectNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hippurate"</span>, <span class="st">"Citrate"</span>, <span class="st">"Time"</span>,</span>
<span>                                     <span class="st">"Hippurate:Time"</span><span class="op">)</span>,</span>
<span>                     modelAbbrev <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     varname.colorup <span class="op">=</span> <span class="st">"Citrate"</span>,</span>
<span>                     varname.colordown  <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>                     varname.pchup<span class="op">=</span><span class="st">"Hippurate"</span>,</span>
<span>                     varname.pchdown<span class="op">=</span><span class="st">"Time"</span>,</span>
<span>                     title <span class="op">=</span> <span class="st">"ASCA-E scores scatterplot matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="UCH_files/figure-html/ASCAE%20ScoresMatrix-1.png" width="250"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>R version 4.3.2 (2023-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] limpca_0.99.4    gridExtra_2.3    ggplot2_3.4.4    pander_0.6.5    
[5] BiocStyle_2.30.0

loaded via a namespace (and not attached):
 [1] tidyr_1.3.1         sass_0.4.8          utf8_1.2.4         
 [4] generics_0.1.3      stringi_1.8.3       digest_0.6.34      
 [7] magrittr_2.0.3      evaluate_0.23       grid_4.3.2         
[10] bookdown_0.37       iterators_1.0.14    fastmap_1.1.1      
[13] plyr_1.8.9          foreach_1.5.2       doParallel_1.0.17  
[16] jsonlite_1.8.8      ggrepel_0.9.5       tidyverse_2.0.0    
[19] BiocManager_1.30.22 purrr_1.0.2         fansi_1.0.6        
[22] scales_1.3.0        codetools_0.2-19    textshaping_0.3.7  
[25] jquerylib_0.1.4     cli_3.6.2           rlang_1.1.3        
[28] munsell_0.5.0       withr_3.0.0         cachem_1.0.8       
[31] yaml_2.3.8          parallel_4.3.2      tools_4.3.2        
[34] reshape2_1.4.4      memoise_2.0.1       dplyr_1.1.4        
[37] colorspace_2.1-0    vctrs_0.6.5         R6_2.5.1           
[40] lifecycle_1.0.4     stringr_1.5.1       fs_1.6.3           
[43] ragg_1.2.7          pkgconfig_2.0.3     desc_1.4.3         
[46] pkgdown_2.0.7       bslib_0.6.1         pillar_1.9.0       
[49] gtable_0.3.4        glue_1.7.0          Rcpp_1.0.12        
[52] systemfonts_1.0.5   highr_0.10          xfun_0.42          
[55] tibble_3.2.1        tidyselect_1.2.0    knitr_1.45         
[58] farver_2.1.1        htmltools_0.5.7     labeling_0.4.3     
[61] ggsci_3.0.0         rmarkdown_2.25      compiler_4.3.2     </code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Guisset2019" class="csl-entry">
Guisset, Severine, Manon Martin, and Bernadette Govaerts. 2019.
<span>“Comparison of PARAFASCA, AComDim, and AMOPLS Approaches in the
Multivariate GLM Modelling of Multi-Factorial Designs.”</span>
<em>Chemometrics and Intelligent Laboratory Systems</em>.
</div>
<div id="ref-Thiel2023" class="csl-entry">
Thiel, Michel, Nadia Benaiche, Manon Martin, Sebastien Franceschini,
Robin Van Oirbeek, and Bernadette Govaerts. 2023. <span>“Limpca : An R
Package for the Linear Modeling of High-Dimensional Designed Data Based
on ASCA/APCA Family of Methods.”</span> <em>Journal of
Chemometrics</em>.
</div>
<div id="ref-Thiel2017" class="csl-entry">
Thiel, Michel, Baptiste Feraud, and Bernadette Govaerts. 2017.
<span>“ASCA+ and APCA+ Extensions of ASCA and APCA in the Analysis of
Unbalanced Multifactorial Designs.”</span> <em>Journal of
Chemometrics</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bernadette Govaerts, Michel Thiel, Manon Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
