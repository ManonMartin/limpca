<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="limpca">
<title>Application of `limpca` on the Trout transcriptomic dataset. • limpca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Application of `limpca` on the Trout transcriptomic dataset.">
<meta property="og:description" content="limpca">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">limpca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.99.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/limpca.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-article">Article</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-article">
    <h6 class="dropdown-header" data-toc-skip>Vignettes</h6>
    <a class="dropdown-item" href="../articles/UCH.html">UCH</a>
    <a class="dropdown-item" href="../articles/Trout.html">Trout</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/suppl_files/suppl_files.html">Supplementary information</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ManonMartin/limpca/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Application of `limpca` on the Trout transcriptomic dataset.</h1>
            <h3 data-toc-skip class="subtitle">Balanced crossed three
way design for fixed factors</h3>
                        <h4 data-toc-skip class="author">Benaiche Nadia,
Bernadette Govaerts</h4>
            
            <h4 data-toc-skip class="date">March 19, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ManonMartin/limpca/blob/HEAD/vignettes/Trout.Rmd" class="external-link"><code>vignettes/Trout.Rmd</code></a></small>
      <div class="d-none name"><code>Trout.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install package if necessary (to be used before running the vignette)</span></span>
<span><span class="co"># if (!requireNamespace("remotes"))</span></span>
<span><span class="co"># install.packages(pkgs="remotes")</span></span>
<span><span class="co"># remotes::install_github("ManonMartin/limpca", dependencies = TRUE)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ManonMartin/limpca" class="external-link">limpca</a></span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gridExtra"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Install 'pander' to knit this vignette"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"pander"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Install 'pander' to knit this vignette"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"car"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Install 'pander' to knit this vignette"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: carData</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>    message <span class="op">=</span> <span class="cn">FALSE</span>, warning <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    comment <span class="op">=</span> <span class="cn">NA</span>, crop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">60</span>, dpi <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    fig.width <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    fig.height <span class="op">=</span> <span class="fl">3.5</span>, dev <span class="op">=</span> <span class="st">"png"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="dataset-and-model-presentation">Dataset and model presentation<a class="anchor" aria-label="anchor" href="#dataset-and-model-presentation"></a>
</h2>
<p>This data set comes from the study of the modulation of immunity in
rainbow trout (Oncorhynchus mykiss) by exposure to cadmium (Cd) combined
with polyunsaturated fatty acids (PUFAs) enriched diets [Cornet et al.,
2018].</p>
<p>The responses were quantified by measuring the modification of the
expression of 15 immune-related genes (m = 15) by RT-qPCR (reverse
transcription quantitative polymerase chain reaction). The experiment
was carried out on 72 trouts and 3 factors were considered in the
experimental design:</p>
<ul>
<li>
<strong>Day</strong>: Measurements on trouts were collected on days
28, 70 and 72</li>
<li>
<strong>Treatment</strong> : Four polyunsaturated fatty acid diets:
alpha-linolenic acid (ALA), linoleic acid (LA), eicosapentaenoic acid
(EPA) and docosahexaenoic acid (DHA)</li>
<li>
<strong>Exposure</strong>: Trouts were exposed (level = 2) or not
(level = 0) to high cadmium concentrations.</li>
</ul>
<p>This gives a 3 × 4 × 2 factorial design. Each of the 24 trials
corresponds to a different aquarium. Three fishes were analysed (3
replicates) for each condition, giving a total of 72 observations.</p>
<p>In this limpca vignette the data are first explored in order to
prepare an appropriate data set for ASCA/APCA analysis. Data are first
represented by PCA and outliers removed. The remaining observations are
then log transformed. Next the data of each aquarium are mean aggregated
in order to avoid the inclusion of an aquarium random factor in the
statistical model because limpca is not yet able to handle mixed linear
models. The data are finally centered and scaled by column.</p>
<p>The estimated model in then a (general) linear model for fixed
factors including main effects and all two way interactions. The three
way interaction is not included because the aggregated design has no
replicate.</p>
<p>A detailed presentation and analysis of this dataset is also
available in [Benaiche, 2022].</p>
</div>
<div class="section level2">
<h2 id="data-import-and-exploration">Data import and exploration<a class="anchor" aria-label="anchor" href="#data-import-and-exploration"></a>
</h2>
<div class="section level3">
<h3 id="data-import-and-design-visualization">Data import and design visualization<a class="anchor" aria-label="anchor" href="#data-import-and-design-visualization"></a>
</h3>
<p>The <code>trout</code> data set is list of three objects : the model
<code>outcomes</code>, the <code>design</code> and the model
<code>formula</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"trout"</span><span class="op">)</span></span>
<span><span class="co"># print number of and response names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n Nb of Responses :  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span>, <span class="st">"\n "</span><span class="op">)</span></span></code></pre></div>
<pre><code>
 Nb of Responses :   15 
 </code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nResponses :\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span>, <span class="st">"\n "</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Responses :
 IL.1b IL6 IL8 Lysozyme IgM MCSFR.a MPO TGF.b TLR3 TLR9 MyD88 SOD Elov5 C3 Cox2 
 </code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order responses by alphabetic order</span></span>
<span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n Ordered responses :\n  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span>, <span class="st">"\n "</span><span class="op">)</span></span></code></pre></div>
<pre><code>
 Ordered responses :
   C3 Cox2 Elov5 IgM IL.1b IL6 IL8 Lysozyme MCSFR.a MPO MyD88 SOD TGF.b TLR3 TLR9 
 </code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print factor names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDesign factors :  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">design</span><span class="op">)</span>, <span class="st">"\n "</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Design factors :   Day Treatment Exposure Aquarium 
 </code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the design with plotDesign function</span></span>
<span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/plotDesign.html">plotDesign</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">trout</span><span class="op">$</span><span class="va">design</span>, x <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Day"</span>, cols <span class="op">=</span> <span class="st">"Exposure"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Initial design of the trout dataset"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/Data%20Importation-1.png" width="250"></p>
<p>This graph confirms that the design is balanced.</p>
</div>
<div class="section level3">
<h3 id="principal-component-analysis-of-row-data">Principal Component Analysis of row data<a class="anchor" aria-label="anchor" href="#principal-component-analysis-of-row-data"></a>
</h3>
<p>Functions <code>pcaBySvd</code>, <code>pcaScreePlot</code> and
<code>pcaScorePlot</code> are used to take a first look at the data by
PCA.</p>
<p>This PCA shows that the data should be log transformed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resPCA</span> <span class="op">&lt;-</span> <span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaBySvd.html">pcaBySvd</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScreePlot.html">pcaScreePlot</a></span><span class="op">(</span><span class="va">resPCA</span>, nPC <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/Exploratory%20PCA-1.png" width="250"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Score plot of original data "</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout</span><span class="op">$</span><span class="va">design</span>, color <span class="op">=</span> <span class="st">"Aquarium"</span>,</span>
<span>    points_labs_rn <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: ggrepel: 64 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
<p><img src="Trout_files/figure-html/Exploratory%20PCA-2.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="log10-transformation-of-the-data-and-new-pca">Log10 transformation of the data and new PCA<a class="anchor" aria-label="anchor" href="#log10-transformation-of-the-data-and-new-pca"></a>
</h3>
<p>Data are log transfomed and a new PCA is applied.</p>
<p>The score plot show clearly two outliers (i.e. fishes D72EPA2.1 and
D28EPA2.2). They will removed of the analysis for the next steps.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log Transformation</span></span>
<span><span class="va">trout_log</span> <span class="op">&lt;-</span> <span class="va">trout</span></span>
<span><span class="va">trout_log</span><span class="op">$</span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># new PCA</span></span>
<span><span class="va">resPCA1</span> <span class="op">&lt;-</span> <span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaBySvd.html">pcaBySvd</a></span><span class="op">(</span><span class="va">trout_log</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScreePlot.html">pcaScreePlot</a></span><span class="op">(</span><span class="va">resPCA1</span>, nPC <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/Transformation-1.png" width="250"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA1</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Score plot of Log10 data "</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_log</span><span class="op">$</span><span class="va">design</span>, color <span class="op">=</span> <span class="st">"Aquarium"</span>,</span>
<span>    drawShapes <span class="op">=</span> <span class="st">"polygon"</span>, points_labs_rn <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: ggrepel: 71 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
<p><img src="Trout_files/figure-html/Transformation-2.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="new-pca-without-the-outliers">New PCA without the outliers<a class="anchor" aria-label="anchor" href="#new-pca-without-the-outliers"></a>
</h3>
<p>New data are created without the 2 outliers and a new PCA performed.
The option <code>polygon</code> of <code>pcaScorePlot</code> function
allows to group data by aquarium. In some aquariums, the 3 fishes shows
very similar results and in other not.</p>
<p>The data are now clean for further analysis</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove outliers and create new dataset</span></span>
<span><span class="va">trout_clean</span> <span class="op">&lt;-</span> <span class="va">trout_log</span></span>
<span><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D72EPA2.1"</span>, <span class="st">"D28EPA2.2"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">trout_log</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">trout_clean</span><span class="op">$</span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="va">trout_log</span><span class="op">$</span><span class="va">outcomes</span><span class="op">[</span><span class="op">-</span><span class="va">outliers</span>, <span class="op">]</span></span>
<span><span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">trout_log</span><span class="op">$</span><span class="va">design</span><span class="op">[</span><span class="op">-</span><span class="va">outliers</span>, <span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PCA</span></span>
<span><span class="va">resPCA2</span> <span class="op">&lt;-</span> <span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaBySvd.html">pcaBySvd</a></span><span class="op">(</span><span class="va">trout_clean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScreePlot.html">pcaScreePlot</a></span><span class="op">(</span><span class="va">resPCA2</span>, nPC <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/new%20PCA-1.png" width="250"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Score plot Components 1 and 2</span></span>
<span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA2</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Score plot of Log10 data without outliers (PC 1&amp;2)"</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span>, color <span class="op">=</span> <span class="st">"Aquarium"</span>,</span>
<span>    drawShapes <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>    points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/new%20PCA-2.png" width="250"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Score plot Components 3 and 4</span></span>
<span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA2</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Score plot of Log10 data without outliers (PC 3&amp;4)"</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span>, color <span class="op">=</span> <span class="st">"Aquarium"</span>,</span>
<span>    drawShapes <span class="op">=</span> <span class="st">"polygon"</span>, points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/new%20PCA-3.png" width="250"></p>
<p>The option <code>polygon</code> of <code>pcaScorePlot</code> function
allows to group data by aquarium. In some aquariums, the 3 fishes shows
very similar results and in other not.</p>
</div>
<div class="section level3">
<h3 id="mean-agregation-by-aquarium-and-scaling">Mean agregation by aquarium and scaling<a class="anchor" aria-label="anchor" href="#mean-agregation-by-aquarium-and-scaling"></a>
</h3>
<p>Data are now mean aggregated by aquarium. This will remove the
hierarchy in the design and allow to apply a classical fixed effect
general linear model to the data.</p>
<p>Data are next centered and scaled by column. This will give the same
importance to each response in the analysis.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean aggregation</span></span>
<span><span class="va">mean_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">24</span>, ncol <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">mean_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">24</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span><span class="op">[[</span><span class="st">"Day"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span><span class="op">[[</span><span class="st">"Treatment"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span><span class="op">[[</span><span class="st">"Exposure"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mean_outcomes</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">trout_clean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">y</span>, <span class="va">mean</span><span class="op">)</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">mean_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">trout_clean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">y</span>, <span class="va">mean</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Set row and col names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mean_outcomes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout_clean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mean_design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout_clean</span><span class="op">$</span><span class="va">design</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">trout_mean_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mean_design</span>, <span class="fl">1</span>, <span class="va">paste</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mean_outcomes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">trout_mean_names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mean_design</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">trout_mean_names</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Outcomes centering and Scaling</span></span>
<span><span class="va">mean_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mean_outcomes</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># New data object creation</span></span>
<span><span class="va">trout_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"outcomes"</span> <span class="op">=</span> <span class="va">mean_outcomes</span>,</span>
<span>    <span class="st">"design"</span> <span class="op">=</span> <span class="va">mean_design</span>,</span>
<span>    <span class="st">"formula"</span> <span class="op">=</span> <span class="va">trout</span><span class="op">$</span><span class="va">formula</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Clean objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span></span>
<span>    <span class="va">resPCA</span>, <span class="va">resPCA1</span>, <span class="va">resPCA2</span>, <span class="va">y</span>, <span class="va">mean_design</span>, <span class="va">mean_outcomes</span>,</span>
<span>    <span class="va">trout_mean_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="exploration-of-aggregated-data">Exploration of aggregated data<a class="anchor" aria-label="anchor" href="#exploration-of-aggregated-data"></a>
</h2>
<p>Aggregated data are now explored.</p>
<div class="section level3">
<h3 id="design">Design<a class="anchor" aria-label="anchor" href="#design"></a>
</h3>
<p>Note that there is no replicate in this new design. There is only one
observation (i.e. one aquarium) for each of the 24 factor
combinations.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:61%;" class="table">
<colgroup>
<col width="19%">
<col width="8%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Day</th>
<th align="center">Treatment</th>
<th align="center">Exposure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D28ALA0</strong></td>
<td align="center">D28</td>
<td align="center">ALA</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D70ALA0</strong></td>
<td align="center">D70</td>
<td align="center">ALA</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D72ALA0</strong></td>
<td align="center">D72</td>
<td align="center">ALA</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D28DHA0</strong></td>
<td align="center">D28</td>
<td align="center">DHA</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D70DHA0</strong></td>
<td align="center">D70</td>
<td align="center">DHA</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D72DHA0</strong></td>
<td align="center">D72</td>
<td align="center">DHA</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/plotDesign.html">plotDesign</a></span><span class="op">(</span></span>
<span>    design <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Design of mean aggregated trout dataset"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/Design-1.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="example-of-lineplot-of-the-responses-for-two-observations">Example of <code>lineplot</code> of the responses for two
observations<a class="anchor" aria-label="anchor" href="#example-of-lineplot-of-the-responses-for-two-observations"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/plotLine.html">plotLine</a></span><span class="op">(</span><span class="va">trout_mean</span><span class="op">$</span><span class="va">outcomes</span>,</span>
<span>    rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>    xaxis_type <span class="op">=</span> <span class="st">"character"</span>, type <span class="op">=</span> <span class="st">"s"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/Lineplot-1.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="pca-aggregated-data">PCA aggregated data<a class="anchor" aria-label="anchor" href="#pca-aggregated-data"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resPCA_mean</span> <span class="op">&lt;-</span> <span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaBySvd.html">pcaBySvd</a></span><span class="op">(</span><span class="va">trout_mean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcaScreePlot.html">pcaScreePlot</a></span><span class="op">(</span><span class="va">resPCA_mean</span>, nPC <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/PCA-1.png" width="250"></p>
<div class="section level4">
<h4 id="score-plots">Score plots<a class="anchor" aria-label="anchor" href="#score-plots"></a>
</h4>
<p>The three score plots below show clearly that the Day is the more
important effect.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA_mean</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"PCA score plot by Exposure and Day"</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"Exposure"</span>, color <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-1-1.png" width="250"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA_mean</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"PCA scores plot by Treatment and Day"</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"Day"</span>, color <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-1-2.png" width="250"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaScorePlot.html">pcaScorePlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA_mean</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"PCA scores plot by Exposure and Treatment"</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"Treatment"</span>, color <span class="op">=</span> <span class="st">"Exposure"</span>,</span>
<span>    points_labs_rn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-1-3.png" width="250"></p>
</div>
<div class="section level4">
<h4 id="d-loading-plots">1D Loading plots<a class="anchor" aria-label="anchor" href="#d-loading-plots"></a>
</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaLoading1dPlot.html">pcaLoading1dPlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA_mean</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"PCA loadings plot trout"</span>, xlab <span class="op">=</span> <span class="st">" "</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Expression"</span>, xaxis_type <span class="op">=</span> <span class="st">"character"</span>, type <span class="op">=</span> <span class="st">"s"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-2-1.png" width="250"></p>
</div>
<div class="section level4">
<h4 id="d-loading-plots-1">2D Loading plots<a class="anchor" aria-label="anchor" href="#d-loading-plots-1"></a>
</h4>
<p>This 2D loading plot allows already to observe that most responses
are correlated with each others. Igm, SOD and TLR9 behave quite
differently.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/pcaLoading2dPlot.html">pcaLoading2dPlot</a></span><span class="op">(</span></span>
<span>    resPcaBySvd <span class="op">=</span> <span class="va">resPCA_mean</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"PCA loadings plot trout"</span>, addRownames <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-3-1.png" width="250"></p>
</div>
</div>
<div class="section level3">
<h3 id="scatterplot-matrix-of-all-15-responses">Scatterplot matrix of all 15 responses<a class="anchor" aria-label="anchor" href="#scatterplot-matrix-of-all-15-responses"></a>
</h3>
<p>The <code>plotScatterM</code> function allows to visualize the 2 by 2
relation between all (or some of) the responses simultaneously and
choose different markers and colors above and below the diagonal
according to factor levels. Strong relations between expressions are
confirmed here for most genes.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/plotScatterM.html">plotScatterM</a></span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">outcomes</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    design <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span>,</span>
<span>    varname.colorup <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    vec.colorup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CadetBlue4"</span>, <span class="st">"pink"</span>, <span class="st">"orange"</span><span class="op">)</span>,</span>
<span>    varname.colordown <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    vec.colordown <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CadetBlue4"</span>, <span class="st">"pink"</span>, <span class="st">"orange"</span><span class="op">)</span>,</span>
<span>    varname.pchup <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    varname.pchdown <span class="op">=</span> <span class="st">"Exposure"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/Scatterplot%20Matrix-1.png" width="500"></p>
</div>
</div>
<div class="section level2">
<h2 id="glm-decomposition">GLM decomposition<a class="anchor" aria-label="anchor" href="#glm-decomposition"></a>
</h2>
<p>The estimated model is the following :</p>
<p><code>outcomes ~ Day + Treatment + Exposure + Day:Treatment + Day:Exposure + Treatment:Exposure</code></p>
<p>Since the design has only one replicate, the three way interaction
has been removed because it is confounded with residuals.</p>
<div class="section level3">
<h3 id="model-matrix-x-generation">Model matrix X generation<a class="anchor" aria-label="anchor" href="#model-matrix-x-generation"></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpModelMatrix</span> <span class="op">&lt;-</span> <span class="fu">limpca</span><span class="fu">::</span><span class="fu"><a href="../reference/lmpModelMatrix.html">lmpModelMatrix</a></span><span class="op">(</span><span class="va">trout_mean</span><span class="op">)</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">resLmpModelMatrix</span><span class="op">$</span><span class="va">modelMatrix</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="17%">
<col width="17%">
<col width="8%">
<col width="8%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">(Intercept)</th>
<th align="center">Day1</th>
<th align="center">Day2</th>
<th align="center">Treatment1</th>
<th align="center">Treatment2</th>
<th align="center">Treatment3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D28ALA0</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D70ALA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D72ALA0</strong></td>
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D28DHA0</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D70DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D72DHA0</strong></td>
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="17%">
<col width="15%">
<col width="22%">
<col width="22%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Exposure1</th>
<th align="center">Day1:Treatment1</th>
<th align="center">Day2:Treatment1</th>
<th align="center">Day1:Treatment2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D28ALA0</strong></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D70ALA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D72ALA0</strong></td>
<td align="center">1</td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D28DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><strong>D70DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D72DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-1</td>
</tr>
</tbody>
</table>
<table style="width:94%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="19%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Day2:Treatment2</th>
<th align="center">Day1:Treatment3</th>
<th align="center">Day2:Treatment3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D28ALA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D70ALA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D72ALA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D28DHA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D70DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D72DHA0</strong></td>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:99%;" class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="19%">
<col width="23%">
<col width="23%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Day1:Exposure1</th>
<th align="center">Day2:Exposure1</th>
<th align="center">Treatment1:Exposure1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D28ALA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>D70ALA0</strong></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><strong>D72ALA0</strong></td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>D28DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D70DHA0</strong></td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D72DHA0</strong></td>
<td align="center">-1</td>
<td align="center">-1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:83%;" class="table">
<colgroup>
<col width="19%">
<col width="31%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Treatment2:Exposure1</th>
<th align="center">Treatment3:Exposure1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>D28ALA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D70ALA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D72ALA0</strong></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D28DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>D70DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>D72DHA0</strong></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="computation-of-effect-matrices-and-importances">Computation of effect matrices and importances<a class="anchor" aria-label="anchor" href="#computation-of-effect-matrices-and-importances"></a>
</h3>
<p>As observed before, the more important effect in the model is the Day
main effect.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpEffectMatrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpEffectMatrices.html">lmpEffectMatrices</a></span><span class="op">(</span><span class="va">resLmpModelMatrix</span><span class="op">)</span></span>
<span><span class="va">resLmpEffectMatrices</span><span class="op">$</span><span class="va">varPercentagesPlot</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/EffectMatrices-1.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="bootstrap-test-of-effect-significance">Bootstrap test of effect significance<a class="anchor" aria-label="anchor" href="#bootstrap-test-of-effect-significance"></a>
</h3>
<p>The bootstrap test shows that, in addition to the Day effect, the
Treatment effect is also significant (p&lt;0.05) and the DxT effect is
nearly significant (p close to 0.1). The corresponding effect matrices
will be studied more deeply by PCA in the next sections.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpBootstrapTests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpBootstrapTests.html">lmpBootstrapTests</a></span><span class="op">(</span></span>
<span>    resLmpEffectMatrices <span class="op">=</span> <span class="va">resLmpEffectMatrices</span>,</span>
<span>    nboot <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print p-values</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">resLmpBootstrapTests</span><span class="op">$</span><span class="va">resultsTable</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="36%">
<col width="12%">
<col width="15%">
<col width="14%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Day</th>
<th align="center">Treatment</th>
<th align="center">Exposure</th>
<th align="center">Day:Treatment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>% of variance (T III)</strong></td>
<td align="center">71.74</td>
<td align="center">8.43</td>
<td align="center">0.67</td>
<td align="center">8.85</td>
</tr>
<tr class="even">
<td align="center"><strong>Bootstrap p-values</strong></td>
<td align="center">&lt; 0.001</td>
<td align="center">0.023</td>
<td align="center">0.568</td>
<td align="center">0.097</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="36%">
<col width="19%">
<col width="27%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Day:Exposure</th>
<th align="center">Treatment:Exposure</th>
<th align="center">Residuals</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>% of variance (T III)</strong></td>
<td align="center">2.07</td>
<td align="center">2.74</td>
<td align="center">5.49</td>
</tr>
<tr class="even">
<td align="center"><strong>Bootstrap p-values</strong></td>
<td align="center">0.355</td>
<td align="center">0.461</td>
<td align="center">-</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="asca-and-apca">ASCA and APCA<a class="anchor" aria-label="anchor" href="#asca-and-apca"></a>
</h2>
<p>Visualization of single or combined effect matrices using ASCA and
APCA. ASCA-E is also provided in <code>limpca</code> but not shown
here.</p>
<div class="section level3">
<h3 id="asca">ASCA<a class="anchor" aria-label="anchor" href="#asca"></a>
</h3>
<div class="section level4">
<h4 id="pca-decomposition-of-effect-matrices">PCA decomposition of effect matrices<a class="anchor" aria-label="anchor" href="#pca-decomposition-of-effect-matrices"></a>
</h4>
<p>In addition to single model effects, a combined effect matrix
<code>Day+Treatment+Day:Treatment</code> also is computed in order to
visualize the combined effect of these two most important factors.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resASCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpPcaEffects.html">lmpPcaEffects</a></span><span class="op">(</span></span>
<span>    resLmpEffectMatrices <span class="op">=</span> <span class="va">resLmpEffectMatrices</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"ASCA"</span>,</span>
<span>    combineEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Day"</span>, <span class="st">"Treatment"</span>,</span>
<span>        <span class="st">"Day:Treatment"</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h4>
<p>Print contributions of each model effect and of each PC for each
effect matrix decomposition by PCA. This last result is given effect by
effect and then reported to the global variance.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resLmpContributions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpContributions.html">lmpContributions</a></span><span class="op">(</span><span class="va">resASCA</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">totalContribTable</span><span class="op">)</span></span></code></pre></div>
<table style="width:69%;" class="table">
<colgroup>
<col width="34%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Percentage of Variance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Day</strong></td>
<td align="center">71.74</td>
</tr>
<tr class="even">
<td align="center"><strong>Treatment</strong></td>
<td align="center">8.43</td>
</tr>
<tr class="odd">
<td align="center"><strong>Exposure</strong></td>
<td align="center">0.67</td>
</tr>
<tr class="even">
<td align="center"><strong>Day:Treatment</strong></td>
<td align="center">8.85</td>
</tr>
<tr class="odd">
<td align="center"><strong>Day:Exposure</strong></td>
<td align="center">2.07</td>
</tr>
<tr class="even">
<td align="center"><strong>Treatment:Exposure</strong></td>
<td align="center">2.74</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">5.49</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">effectTable</span><span class="op">)</span></span></code></pre></div>
<table style="width:99%;" class="table">
<colgroup>
<col width="34%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="9%">
<col width="9%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Day</strong></td>
<td align="center">88.66</td>
<td align="center">11.34</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Treatment</strong></td>
<td align="center">72.02</td>
<td align="center">23.61</td>
<td align="center">4.36</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">99.99</td>
</tr>
<tr class="odd">
<td align="center"><strong>Exposure</strong></td>
<td align="center">100</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Day:Treatment</strong></td>
<td align="center">47.35</td>
<td align="center">21.52</td>
<td align="center">17.42</td>
<td align="center">8.97</td>
<td align="center">2.8</td>
<td align="center">98.06</td>
</tr>
<tr class="odd">
<td align="center"><strong>Day:Exposure</strong></td>
<td align="center">81.01</td>
<td align="center">18.99</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center"><strong>Treatment:Exposure</strong></td>
<td align="center">78.74</td>
<td align="center">15.81</td>
<td align="center">5.46</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">39.25</td>
<td align="center">28.02</td>
<td align="center">17.55</td>
<td align="center">8.76</td>
<td align="center">4.49</td>
<td align="center">98.07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">contribTable</span><span class="op">)</span></span></code></pre></div>
<table style="width:99%;" class="table">
<colgroup>
<col width="34%">
<col width="11%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">Contrib</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Day</strong></td>
<td align="center">63.61</td>
<td align="center">8.14</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">71.74</td>
</tr>
<tr class="even">
<td align="center"><strong>Treatment</strong></td>
<td align="center">6.07</td>
<td align="center">1.99</td>
<td align="center">0.37</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">8.43</td>
</tr>
<tr class="odd">
<td align="center"><strong>Exposure</strong></td>
<td align="center">0.67</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0.67</td>
</tr>
<tr class="even">
<td align="center"><strong>Day:Treatment</strong></td>
<td align="center">4.19</td>
<td align="center">1.9</td>
<td align="center">1.54</td>
<td align="center">0.79</td>
<td align="center">0.25</td>
<td align="center">8.85</td>
</tr>
<tr class="odd">
<td align="center"><strong>Day:Exposure</strong></td>
<td align="center">1.68</td>
<td align="center">0.39</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">2.07</td>
</tr>
<tr class="even">
<td align="center"><strong>Treatment:Exposure</strong></td>
<td align="center">2.16</td>
<td align="center">0.43</td>
<td align="center">0.15</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">2.74</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">2.16</td>
<td align="center">1.54</td>
<td align="center">0.96</td>
<td align="center">0.48</td>
<td align="center">0.25</td>
<td align="center">5.49</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">combinedEffectTable</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="42%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="8%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Day+Treatment+Day:Treatment</strong></td>
<td align="center">75.51</td>
<td align="center">10.08</td>
<td align="center">6.53</td>
<td align="center">3.62</td>
<td align="center">1.91</td>
<td align="center">97.65</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">39.25</td>
<td align="center">28.02</td>
<td align="center">17.55</td>
<td align="center">8.76</td>
<td align="center">4.49</td>
<td align="center">98.07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Visualize the more important contributions</span></span>
<span><span class="va">resLmpContributions</span><span class="op">$</span><span class="va">plotContrib</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20ContribP-1.png" width="250"></p>
</div>
<div class="section level4">
<h4 id="scores-and-loadings-plots">Scores and loadings plots<a class="anchor" aria-label="anchor" href="#scores-and-loadings-plots"></a>
</h4>
<p>2D Score plots of the most important effects and of the residual
matrix are given below with their related loading plots. These allow to
see for which response each effect is or is not important</p>
<div class="section level5">
<h5 id="day-effect">Day effect<a class="anchor" aria-label="anchor" href="#day-effect"></a>
</h5>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Day"</span>, shape <span class="op">=</span> <span class="st">"Day"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    points_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20Day-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="treatment-effect">Treatment effect<a class="anchor" aria-label="anchor" href="#treatment-effect"></a>
</h5>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Treatment"</span>, shape <span class="op">=</span> <span class="st">"Treatment"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    points_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20Treatment-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="daytreatment-effect">Day:Treatment effect<a class="anchor" aria-label="anchor" href="#daytreatment-effect"></a>
</h5>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day:Treatment"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Treatment"</span>, shape <span class="op">=</span> <span class="st">"Day"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day:Treatment"</span>,</span>
<span>    points_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20DayTreatment-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="combined-daytreatmentdaytreatment-effect">Combined Day+Treatment+Day:Treatment effect<a class="anchor" aria-label="anchor" href="#combined-daytreatmentdaytreatment-effect"></a>
</h5>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day+Treatment+Day:Treatment"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Treatment"</span>, shape <span class="op">=</span> <span class="st">"Day"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day+Treatment+Day:Treatment"</span>,</span>
<span>    points_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20Combined%20effect-1.png" width="250"></p>
</div>
<div class="section level5">
<h5 id="residual-matrix-decomposition">Residual matrix decomposition<a class="anchor" aria-label="anchor" href="#residual-matrix-decomposition"></a>
</h5>
<p>The score and loading plot of the residual matrix does not show any
special pattern.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Treatment"</span>, shape <span class="op">=</span> <span class="st">"Day"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpLoading2dPlot.html">lmpLoading2dPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>    points_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trout</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20Residuals-1.png" width="250"></p>
</div>
</div>
<div class="section level4">
<h4 id="effect-plots-on-scores">Effect plots on scores<a class="anchor" aria-label="anchor" href="#effect-plots-on-scores"></a>
</h4>
<p>Interaction effects are difficult to visualize in 2D score plots.
Effect plots are interesting in this context. It show the effect of one
factor on a PC for different level of the other.</p>
<p>Below the Day:Treament interaction effect is drawn alone and then
combined with the two related main effects.</p>
<p>The second graph shows that their is some interaction effect but
small compared to the Day and even treatment main effects.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectName <span class="op">=</span> <span class="st">"Day:Treatment"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Day"</span>, z <span class="op">=</span> <span class="st">"Treatment"</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">A</span><span class="op">$</span><span class="va">PC1</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">$</span><span class="va">PC1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"PC1: Day:Treatment effect alone"</span><span class="op">)</span></span>
<span><span class="va">A</span><span class="op">$</span><span class="va">PC2</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">$</span><span class="va">PC2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"PC2: Day:Treatment effect alone"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span><span class="op">$</span><span class="va">PC1</span>, <span class="va">A</span><span class="op">$</span><span class="va">PC2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20Effects-1.png" width="250"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpEffectPlot.html">lmpEffectPlot</a></span><span class="op">(</span><span class="va">resASCA</span>,</span>
<span>    effectName <span class="op">=</span> <span class="st">"Day+Treatment+Day:Treatment"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Day"</span>, z <span class="op">=</span> <span class="st">"Treatment"</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">A</span><span class="op">$</span><span class="va">PC1</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">$</span><span class="va">PC1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"PC1: Combined D+T+D:T effects"</span><span class="op">)</span></span>
<span><span class="va">A</span><span class="op">$</span><span class="va">PC2</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">$</span><span class="va">PC2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"PC2: Combined D+T+D:T effects"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">A</span><span class="op">$</span><span class="va">PC1</span>, <span class="va">A</span><span class="op">$</span><span class="va">PC2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/ASCA%20Effects-2.png" width="250"></p>
</div>
</div>
<div class="section level3">
<h3 id="apca">APCA<a class="anchor" aria-label="anchor" href="#apca"></a>
</h3>
<p>APCA allows to visualize by PCA each model effect added to model
residuals. It gives an idea of the effects signal to noise ratio and
significance. Be care that the significance depends also crucially of
the number of observations in the experiment.</p>
<p>In APCA the score plots are the more interesting graphics to look at.
We then only give them here for all model effects.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resAPCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lmpPcaEffects.html">lmpPcaEffects</a></span><span class="op">(</span></span>
<span>    resLmpEffectMatrices <span class="op">=</span></span>
<span>        <span class="va">resLmpEffectMatrices</span>, method <span class="op">=</span> <span class="st">"APCA"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Day Effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Day"</span>, shape <span class="op">=</span> <span class="st">"Day"</span>, drawShapes <span class="op">=</span> <span class="st">"ellipse"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/APCA%20Scores-1.png" width="250"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Treatment Effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Treatment"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Treatment"</span>, shape <span class="op">=</span> <span class="st">"Treatment"</span>, drawShapes <span class="op">=</span> <span class="st">"ellipse"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning:  [1m [22mRemoved 30 rows containing missing values or values outside the scale range
(`geom_path()`).</code></pre>
<p><img src="Trout_files/figure-html/APCA%20Scores-2.png" width="250"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exposure Effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Exposure"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Exposure"</span>, shape <span class="op">=</span> <span class="st">"Exposure"</span>, drawShapes <span class="op">=</span> <span class="st">"ellipse"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/APCA%20Scores-3.png" width="250"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Day:Treatment Effect</span></span>
<span><span class="fu"><a href="../reference/lmpScorePlot.html">lmpScorePlot</a></span><span class="op">(</span><span class="va">resAPCA</span>,</span>
<span>    effectNames <span class="op">=</span> <span class="st">"Day:Treatment"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Treatment"</span>, shape <span class="op">=</span> <span class="st">"Day"</span>, drawShapes <span class="op">=</span> <span class="st">"polygon"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/APCA%20Scores-4.png" width="250"></p>
</div>
</div>
<div class="section level2">
<h2 id="univariate-anova">Univariate ANOVA<a class="anchor" aria-label="anchor" href="#univariate-anova"></a>
</h2>
<p>This part of the vignette links the results of the ASCA/APCA analysis
to a more classical analysis applied in -omics transcriptomic data
analysis (see e.g. <code>LIMMA</code> package).</p>
<p>An ANOVA model is fitted to each response separately and then, for
each model effect, p-values of effect significance are corrected by FDR
and ordered. These results allow to detect for which responses each
effect of interest is significant. E.g. find which gene is a potential
biomarker to differentiate patients with or without a given disease.</p>
<p>The code below applies such analysis and compares then responses
importance based on FDR p-values to response loadings obtained by
ASCA/APCA.</p>
<div class="section level3">
<h3 id="parallel-anova-modeling-and-fdr-p-value-corrections">Parallel ANOVA modeling and FDR p-value corrections<a class="anchor" aria-label="anchor" href="#parallel-anova-modeling-and-fdr-p-value-corrections"></a>
</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creation of a matrix to store the p-values</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">trout_mean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="va">mat_pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">mat_pval</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">trout_mean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Day"</span>, <span class="st">"Treatment"</span>, <span class="st">"Exposure"</span>, <span class="st">"Day:Treatment"</span>,</span>
<span>        <span class="st">"Day:Exposure"</span>, <span class="st">"Treatment:Exposure"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parallel ANOVA modeling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">trout_mean</span><span class="op">$</span><span class="va">outcomes</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, <span class="va">trout_mean</span><span class="op">$</span><span class="va">design</span><span class="op">)</span></span>
<span>    <span class="va">Modl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">Day</span> <span class="op">+</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Exposure</span> <span class="op">+</span> <span class="va">Day</span><span class="op">:</span><span class="va">Treatment</span> <span class="op">+</span> <span class="va">Day</span><span class="op">:</span><span class="va">Exposure</span> <span class="op">+</span> <span class="va">Treatment</span><span class="op">:</span><span class="va">Exposure</span>,</span>
<span>        contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Day <span class="op">=</span> <span class="va">contr.sum</span>, Treatment <span class="op">=</span> <span class="va">contr.sum</span>, Exposure <span class="op">=</span> <span class="va">contr.sum</span><span class="op">)</span>,</span>
<span>        data <span class="op">=</span> <span class="va">data</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">tabanova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Modl</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="va">mat_pval</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tabanova</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">4</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># FDR p-values correction</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="va">mat_pval</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">mat_pval</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fdr-corrected-p_values-q-values">FDR corrected p_values (q-values)<a class="anchor" aria-label="anchor" href="#fdr-corrected-p_values-q-values"></a>
</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">mat_pval</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="18%">
<col width="14%">
<col width="14%">
<col width="13%">
<col width="19%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Day</th>
<th align="center">Treatment</th>
<th align="center">Exposure</th>
<th align="center">Day:Treatment</th>
<th align="center">Day:Exposure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>C3</strong></td>
<td align="center">0.0005514</td>
<td align="center">0.4772</td>
<td align="center">0.9769</td>
<td align="center">0.9457</td>
<td align="center">0.8465</td>
</tr>
<tr class="even">
<td align="center"><strong>Cox2</strong></td>
<td align="center">0.0002609</td>
<td align="center">0.3833</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.8172</td>
</tr>
<tr class="odd">
<td align="center"><strong>Elov5</strong></td>
<td align="center">7.56e-05</td>
<td align="center">0.3833</td>
<td align="center">0.995</td>
<td align="center">0.9457</td>
<td align="center">0.8465</td>
</tr>
<tr class="even">
<td align="center"><strong>IgM</strong></td>
<td align="center">0.004411</td>
<td align="center">0.1362</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.8465</td>
</tr>
<tr class="odd">
<td align="center"><strong>IL.1b</strong></td>
<td align="center">0.0002609</td>
<td align="center">0.1485</td>
<td align="center">0.9183</td>
<td align="center">0.773</td>
<td align="center">0.8172</td>
</tr>
<tr class="even">
<td align="center"><strong>IL6</strong></td>
<td align="center">0.0003037</td>
<td align="center">0.273</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.8172</td>
</tr>
<tr class="odd">
<td align="center"><strong>IL8</strong></td>
<td align="center">0.0002609</td>
<td align="center">0.3833</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.8172</td>
</tr>
<tr class="even">
<td align="center"><strong>Lysozyme</strong></td>
<td align="center">0.0002791</td>
<td align="center">0.2254</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.8172</td>
</tr>
<tr class="odd">
<td align="center"><strong>MCSFR.a</strong></td>
<td align="center">2.327e-05</td>
<td align="center">0.1362</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.9502</td>
</tr>
<tr class="even">
<td align="center"><strong>MPO</strong></td>
<td align="center">7.251e-05</td>
<td align="center">0.2254</td>
<td align="center">0.9183</td>
<td align="center">0.9457</td>
<td align="center">0.8465</td>
</tr>
<tr class="odd">
<td align="center"><strong>MyD88</strong></td>
<td align="center">2.327e-05</td>
<td align="center">0.1362</td>
<td align="center">0.995</td>
<td align="center">0.7736</td>
<td align="center">0.8172</td>
</tr>
<tr class="even">
<td align="center"><strong>SOD</strong></td>
<td align="center">0.001557</td>
<td align="center">0.3833</td>
<td align="center">0.9769</td>
<td align="center">0.7334</td>
<td align="center">0.8172</td>
</tr>
<tr class="odd">
<td align="center"><strong>TGF.b</strong></td>
<td align="center">0.000362</td>
<td align="center">0.2887</td>
<td align="center">0.995</td>
<td align="center">0.9457</td>
<td align="center">0.9364</td>
</tr>
<tr class="even">
<td align="center"><strong>TLR3</strong></td>
<td align="center">0.01301</td>
<td align="center">0.2254</td>
<td align="center">0.9183</td>
<td align="center">0.773</td>
<td align="center">0.8172</td>
</tr>
<tr class="odd">
<td align="center"><strong>TLR9</strong></td>
<td align="center">0.2085</td>
<td align="center">0.2254</td>
<td align="center">0.995</td>
<td align="center">0.7334</td>
<td align="center">0.8172</td>
</tr>
</tbody>
</table>
<table style="width:50%;" class="table">
<colgroup>
<col width="20%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">Treatment:Exposure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>C3</strong></td>
<td align="center">0.9638</td>
</tr>
<tr class="even">
<td align="center"><strong>Cox2</strong></td>
<td align="center">0.9625</td>
</tr>
<tr class="odd">
<td align="center"><strong>Elov5</strong></td>
<td align="center">0.9638</td>
</tr>
<tr class="even">
<td align="center"><strong>IgM</strong></td>
<td align="center">0.7775</td>
</tr>
<tr class="odd">
<td align="center"><strong>IL.1b</strong></td>
<td align="center">0.6085</td>
</tr>
<tr class="even">
<td align="center"><strong>IL6</strong></td>
<td align="center">0.6085</td>
</tr>
<tr class="odd">
<td align="center"><strong>IL8</strong></td>
<td align="center">0.7775</td>
</tr>
<tr class="even">
<td align="center"><strong>Lysozyme</strong></td>
<td align="center">0.7775</td>
</tr>
<tr class="odd">
<td align="center"><strong>MCSFR.a</strong></td>
<td align="center">0.6085</td>
</tr>
<tr class="even">
<td align="center"><strong>MPO</strong></td>
<td align="center">0.7775</td>
</tr>
<tr class="odd">
<td align="center"><strong>MyD88</strong></td>
<td align="center">0.09138</td>
</tr>
<tr class="even">
<td align="center"><strong>SOD</strong></td>
<td align="center">0.7775</td>
</tr>
<tr class="odd">
<td align="center"><strong>TGF.b</strong></td>
<td align="center">0.9625</td>
</tr>
<tr class="even">
<td align="center"><strong>TLR3</strong></td>
<td align="center">0.9625</td>
</tr>
<tr class="odd">
<td align="center"><strong>TLR9</strong></td>
<td align="center">0.9638</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">mat_pval</span><span class="op">)</span>,</span>
<span>    Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="st">"Rowv"</span>,</span>
<span>    cexCol <span class="op">=</span> <span class="fl">0.8</span>, scale <span class="op">=</span> <span class="st">"none"</span>, main <span class="op">=</span> <span class="st">"Heatmap of -log10(q-values)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-4-1.png" width="250"></p>
</div>
<div class="section level3">
<h3 id="plot-asca-loadings-versus--log10q-values">Plot ASCA loadings versus -log10(q-values)<a class="anchor" aria-label="anchor" href="#plot-asca-loadings-versus--log10q-values"></a>
</h3>
<p>Plot the relation between the ASCA loadings and FDR p-values for the
three more important effects of the model : Day, Treatment and
Day:Treatment.</p>
<p>FDR p-values are log transformed and loadings are summarized over the
2 first components.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Effects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Day"</span>, <span class="st">"Treatment"</span>, <span class="st">"Day:Treatment"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pval_log</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">mat_pval</span><span class="op">[</span>, <span class="va">Effects</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">resA</span> <span class="op">&lt;-</span> <span class="va">resASCA</span><span class="op">[[</span><span class="va">Effects</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">PC12Load</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">resA</span><span class="op">$</span><span class="va">loadings</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">resA</span><span class="op">$</span><span class="va">singvar</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">matres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">PC12Load</span>, <span class="va">Pval_log</span><span class="op">)</span></span>
<span>    <span class="va">A</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotScatter.html">plotScatter</a></span><span class="op">(</span></span>
<span>        Y <span class="op">=</span> <span class="va">matres</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        points_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">matres</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"PC1&amp;2 ASCA loadings"</span>, ylab <span class="op">=</span> <span class="st">"-log10(p-values)"</span>,</span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Effects</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"effect"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">A</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code>Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
<p><img src="Trout_files/figure-html/unnamed-chunk-5-1.png" width="250"></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="Trout_files/figure-html/unnamed-chunk-5-2.png" width="250"></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code>Warning: ggrepel: 6 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
<p><img src="Trout_files/figure-html/unnamed-chunk-5-3.png" width="250"></p>
</div>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] car_3.1-2        carData_3.0-5    pander_0.6.5     gridExtra_2.3   
[5] limpca_0.99.5    ggplot2_3.5.0    BiocStyle_2.30.0

loaded via a namespace (and not attached):
 [1] tidyr_1.3.1         sass_0.4.9          utf8_1.2.4         
 [4] generics_0.1.3      stringi_1.8.3       digest_0.6.35      
 [7] magrittr_2.0.3      evaluate_0.23       grid_4.3.3         
[10] bookdown_0.38       iterators_1.0.14    fastmap_1.1.1      
[13] plyr_1.8.9          foreach_1.5.2       doParallel_1.0.17  
[16] jsonlite_1.8.8      ggrepel_0.9.5       tidyverse_2.0.0    
[19] BiocManager_1.30.22 purrr_1.0.2         fansi_1.0.6        
[22] scales_1.3.0        codetools_0.2-19    textshaping_0.3.7  
[25] jquerylib_0.1.4     abind_1.4-5         cli_3.6.2          
[28] rlang_1.1.3         munsell_0.5.0       withr_3.0.0        
[31] cachem_1.0.8        yaml_2.3.8          tools_4.3.3        
[34] parallel_4.3.3      reshape2_1.4.4      memoise_2.0.1      
[37] dplyr_1.1.4         colorspace_2.1-0    vctrs_0.6.5        
[40] R6_2.5.1            lifecycle_1.0.4     stringr_1.5.1      
[43] fs_1.6.3            ragg_1.3.0          pkgconfig_2.0.3    
[46] desc_1.4.3          pkgdown_2.0.7       pillar_1.9.0       
[49] bslib_0.6.1         gtable_0.3.4        glue_1.7.0         
[52] Rcpp_1.0.12         systemfonts_1.0.6   highr_0.10         
[55] xfun_0.42           tibble_3.2.1        tidyselect_1.2.1   
[58] knitr_1.45          farver_2.1.1        htmltools_0.5.7    
[61] labeling_0.4.3      rmarkdown_2.26      ggsci_3.0.1        
[64] compiler_4.3.3     </code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Benaiche, N., (2022), Stabilisation of the R package LMWiRe – Linear
Models for Wide Responses. <em>UCLouvain</em>, <a href="http://hdl.handle.net/2078.1/thesis:33996" class="external-link uri">http://hdl.handle.net/2078.1/thesis:33996</a></p>
<p>Cornet, V., Ouaach, A., Mandiki, S., Flamion, E., Ferain, A., Van
Larebeke, M., Lemaire, B., Reyes Lopez F., Tort, L., Larondelle, Y. and
Kestemont, P., (2018), Environmentally-realistic concentration of
cadmium combined with polyunsaturated fatty acids enriched diets
modulated non-specific immunity in rainbow trout. <em>Aquatic
Toxicology</em>, <strong>196</strong>, 104–116. <a href="https://doi.org/10.1016/j.aquatox.2018.01.012" class="external-link uri">https://doi.org/10.1016/j.aquatox.2018.01.012</a></p>
<p>Thiel, M., Feraud, B. and Govaerts, B. (2017), ASCA+ and APCA+:
exten- sions of ASCA and APCA in the analysis of unbalanced
multifactorial designs. <em>Journal of Chemometrics</em>.
<strong>31</strong> <a href="https://doi.org/10.1002/cem.2895" class="external-link uri">https://doi.org/10.1002/cem.2895</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bernadette Govaerts, Michel Thiel, Manon Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
